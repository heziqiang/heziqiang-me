## 项目背景

阿里巴巴的双十一购物节，千亿GMV背后是百万活动页面。早期每逢大促活动，都需要投入数百名开发者手动开发页面，效率低、成本高。随着双十一等业务增长到了一个新的高度，这个时候需要一个新的平台来支持。

我有幸作为 天马搭建平台 的首批开发者，负责搭建系统的底层的设计和实现。

时间：2018.2 - 2019.10

## 技术架构

因为要支持的业务很多，整体技术架构比较庞大，篇幅原因这里只做简要原理介绍。
![这是图片](/ali_pbs_architecture.png)

### 名词概念

- 模块：运营同学搭建页面使用的最小单位，包括但不限于文字、图片、视频、表单等元素
- 页面搭建：从模块到页面的组合过程，在页面编辑器中完成
- 数据投放：对接电商的实时数据，包括但不限于活动、商品、优惠等数据
- 终端：目标用户的运行环境，支持PC端和移动端

### 流程设计

![这是图片](/ali_pbs_process.png)

### 编辑时：

搭建服务：提供了基础的模块，页面，管理实体的 SDK，负责各种搭建实体的增删改查以及协议规范

投放服务：提供了资源位，排期，数据源，投放规则的 SDK，负责各种投放实体的增删改查以及协议规范

页面编辑器：

运营同学可以在页面编辑器中选择模块，组合出想要的页面布局，同时投放业务数据、设置发布时间计划等。
![这是图片](/ali_pbs_editor.png)

### 运行时：

渲染服务：基于从离线链路获取的页面和模块代码、页面配置组装出页面的模板

数据服务：基于从离线链路获取的模块资源位数据配置，进行数据处理，并合并生成页面需要的数据

### 性能优化

通过对网页从url输入到主要资源加载完成的主要过程各个环境进行了性能优化，包括不限于：获取 url -> 重定向 -> 服务端缓存 -> DNS查询 -> 建链 -> 文档传输 -> 文档资源解析和处理 -> 主要资源加载完成。
![这是图片](/browser_performance_timing.png)

### 终端展示

![这是图片](/ali_pbs_preview.png)
截止2020年，已经完成了十几个集团BU接入和搭建支持，产出了11000+个模块，发布了100万+张页面，覆盖了3万+阿里运营及几十万的商家。
